{% include __vars.md %}

<nav id="top_nav" class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#canfar_navbar_collapse" aria-expanded="false">
        <span class="sr-only">{{ t.toggle_navigation }}</span>
      </button>
      <a class="navbar-brand" href="{{ page_lang_link }}"><img src="{{ '/css/images/logo.png' | prepend: site.baseurl }}"></a>
    </div>

    <div id="canfar_navbar_collapse" class="collapse navbar-collapse">
      <ul id="navbar_list" class="nav navbar-nav pull-right">
        <!-- Uncomment this to have a language switcher. -->
        <!--<li class="dropdown">-->
          <!--<a href="{{ page_lang_link }}" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="text-success">{{ page.lang }}</span> <span class="caret"></span></a>-->
          <!--<ul class="dropdown-menu list-unstyled">-->
            <!--{% comment %}-->
            <!--{% for lang in site.data.translations %}-->
            <!--{% assign this_lang = lang[0] %}-->
            <!--{% if this_lang != page.lang %}-->
              <!--{% assign tx = site.data.translations[this_lang] %}-->
              <!--{% assign child_item_x = tx %}-->

              <!--{% if page_namespace_items.size > 0 %}-->
                <!--{% for hier_item in page_namespace_items %}-->
                  <!--{% assign child_item_x = child_item_x[hier_item] %}-->
                  <!--{% capture child_url_x %}{{child_url_x}}{{child_item_x.link}}{% endcapture %}-->
                <!--{% endfor %}-->
              <!--{% else %}-->
                <!--{% assign child_item_x = tx[parent_namespace] %}-->
              <!--{% endif %}-->

              <!--{% capture this_lang_link %}/{{this_lang}}{% endcapture %}-->
            <!--<li><a href="{{ this_lang_link | prepend: site.baseurl }}{{ child_url_x }}" lang="{{ this_lang }}">{{ this_lang }}</a></li>-->
            <!--{% endif %}-->
            <!--{% endfor %}-->
            <!--{% endcomment %}-->
          <!--</ul>-->
        <!--</li>-->
        {% include __top_menu_pulldown.md name='nodes' %}
        {% include __top_menu_pulldown.md name='resources' %}
        {% include __top_menu_pulldown.md name='about' %}
        
        <li class="dropdown">
          {% if username %}
            <!--<script src='/javascript/{{ login_javascript.js }}' type="text/javascript"></script>-->
          <!-- Goal is to have a javascript file that generates this part of the DOM. Not sure it can be done
                with the 'username' parameter needing to be passed in.
              function would also be checking if the person is actually logged in. -->
            <a title="User actions." class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-toggle="dropdown">
              {{ username }} <span class="caret"></span></a>
            <ul class="dropdown-menu list-unstyled">
              <li>
                <a title="Update profile." href="#">My profile</a></li>
              <li>
                <a title="Change password." href="#">Change password</a></li>
              <li>
                <a id="logout" title="Logout."><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
            </ul>
          {% else %}
            <a title="Login form" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-toggle="dropdown">
              {{ t.login.name }} <span class="caret"></span></a>
            <ul class="dropdown-menu list-unstyled pull-right login-container">
              <li>
                <form class="form-inline" id="loginForm" role="form" method="post"
                      action="http://apps.canfar.net/storage-beta/ac/authenticate">
                  <span id="login_fail" class="help-block text-danger pull-left"></span>
                  <div class="form-group">
                    <label for="username" class="hidden" id="usernameLabel">Username</label>
                    <input type="text" id="username" name="username" class="form-control" tabindex="1" required="required" placeholder="Username" />
                  </div>
                  <div class="form-group">
                    <label for="password" class="hidden" id="passwordLabel">Password</label>
                    <input type="password" id="password" name="password" class="form-control" tabindex="2" required="required" placeholder="Password" />
                  </div>
                  <input type="hidden" id="redirectPath" name="redirectPath" value="${folder.path}" />
                  <button type="submit" class="btn btn-success"><span class="glyphicon glyphicon-log-in"></span> Login</button>
                </form>
              </li>
            </ul>
          {% endif %}
        </li>

      </ul>
    </div> <!-- end .navbar-collapse -->
  </div> <!-- end .conatiner -->
</nav>
